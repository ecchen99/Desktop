/*Number of Vaccination Facilities and Overall Access Relationship*/
/*Add IL COVID-19 Regions to Database Table*/
ALTER TABLE Vaccine_Facilities
ADD Region VARCHAR(255);

UPDATE Vaccine_Facilities
SET Region = 'Region 1'
WHERE
facility_sub_region_1 = 'Illinois'
AND (facility_sub_region_2 = 'Boone County'
OR facility_sub_region_2 = 'Carroll County'
OR facility_sub_region_2 = 'DeKalb County'
OR facility_sub_region_2 = 'Jo Daviess County'
OR facility_sub_region_2 = 'Lee County'
OR facility_sub_region_2 = 'Ogle County'
OR facility_sub_region_2 = 'Stephenson County'
OR facility_sub_region_2 = 'Whiteside County'
OR facility_sub_region_2 = 'Winnebago County');

UPDATE Vaccine_Facilities
SET Region = 'Region 2'
WHERE
facility_sub_region_1 = 'Illinois'
AND (facility_sub_region_2 = 'Bureau County'
OR facility_sub_region_2 = 'Fulton County'
OR facility_sub_region_2 = 'Grundy County'
OR facility_sub_region_2 = 'Henderson County'
OR facility_sub_region_2 = 'Henry County'
OR facility_sub_region_2 = 'Kendall County'
OR facility_sub_region_2 = 'Knox County'
OR facility_sub_region_2 = 'La Salle County'
OR facility_sub_region_2 = 'Livingston County'
OR facility_sub_region_2 = 'Marshall County'
OR facility_sub_region_2 = 'McDonough County'
OR facility_sub_region_2 = 'McLean County'
OR facility_sub_region_2 = 'Mercer County'
OR facility_sub_region_2 = 'Peoria County'
OR facility_sub_region_2 = 'Putnam County'
OR facility_sub_region_2 = 'Rock Island County'
OR facility_sub_region_2 = 'Stark County'
OR facility_sub_region_2 = 'Tazewell County'
OR facility_sub_region_2 = 'Warren County'
OR facility_sub_region_2 = 'Woodford County');

UPDATE Vaccine_Facilities
SET Region = 'Region 3'
WHERE
facility_sub_region_1 = 'Illinois'
AND (facility_sub_region_2 = 'Adams County'
OR facility_sub_region_2 = 'Brown County'
OR facility_sub_region_2 = 'Calhoun County'
OR facility_sub_region_2 = 'Cass County'
OR facility_sub_region_2 = 'Christian County'
OR facility_sub_region_2 = 'Greene County'
OR facility_sub_region_2 = 'Hancock County'
OR facility_sub_region_2 = 'Jersey County'
OR facility_sub_region_2 = 'Logan County'
OR facility_sub_region_2 = 'Macoupin County'
OR facility_sub_region_2 = 'Mason County'
OR facility_sub_region_2 = 'Menard County'
OR facility_sub_region_2 = 'Montgomery County'
OR facility_sub_region_2 = 'Morgan County'
OR facility_sub_region_2 = 'Pike County'
OR facility_sub_region_2 = 'Sangamon County'
OR facility_sub_region_2 = 'Schuyler County'
OR facility_sub_region_2 = 'Scott County');

UPDATE Vaccine_Facilities
SET Region = 'Region 4'
WHERE
facility_sub_region_1 = 'Illinois'
AND (facility_sub_region_2 = 'Bond County'
OR facility_sub_region_2 = 'Clinton County'
OR facility_sub_region_2 = 'Madison County'
OR facility_sub_region_2 = 'Monroe County'
OR facility_sub_region_2 = 'Randolph County'
OR facility_sub_region_2 = 'St. Clair County'
OR facility_sub_region_2 = 'Washington County');

UPDATE Vaccine_Facilities
SET Region = 'Region 5'
WHERE
facility_sub_region_1 = 'Illinois'
AND (facility_sub_region_2 = 'Alexander County'
OR facility_sub_region_2 = 'Edwards County'
OR facility_sub_region_2 = 'Franklin County'
OR facility_sub_region_2 = 'Gallatin County'
OR facility_sub_region_2 = 'Hamilton County'
OR facility_sub_region_2 = 'Hardin County'
OR facility_sub_region_2 = 'Jackson County'
OR facility_sub_region_2 = 'Jefferson County'
OR facility_sub_region_2 = 'Johnson County'
OR facility_sub_region_2 = 'Marion County'
OR facility_sub_region_2 = 'Massac County'
OR facility_sub_region_2 = 'Perry County'
OR facility_sub_region_2 = 'Pope County'
OR facility_sub_region_2 = 'Pulaski County'
OR facility_sub_region_2 = 'Saline County'
OR facility_sub_region_2 = 'Union County'
OR facility_sub_region_2 = 'Wabash County'
OR facility_sub_region_2 = 'Wayne County'
OR facility_sub_region_2 = 'White County'
OR facility_sub_region_2 = 'Williamson County');

UPDATE Vaccine_Facilities
SET Region = 'Region 6'
WHERE
facility_sub_region_1 = 'Illinois'
AND (facility_sub_region_2 = 'Champaign County'
OR facility_sub_region_2 = 'Clark County'
OR facility_sub_region_2 = 'Clay County'
OR facility_sub_region_2 = 'Coles County'
OR facility_sub_region_2 = 'Crawford County'
OR facility_sub_region_2 = 'Cumberland County'
OR facility_sub_region_2 = 'De Witt County'
OR facility_sub_region_2 = 'Douglas County'
OR facility_sub_region_2 = 'Edgar County'
OR facility_sub_region_2 = 'Effingham County'
OR facility_sub_region_2 = 'Fayette County'
OR facility_sub_region_2 = 'Ford County'
OR facility_sub_region_2 = 'Iroquois County'
OR facility_sub_region_2 = 'Jasper County'
OR facility_sub_region_2 = 'Lawrence County'
OR facility_sub_region_2 = 'Macon County'
OR facility_sub_region_2 = 'Molutrie County'
OR facility_sub_region_2 = 'Piatt County'
OR facility_sub_region_2 = 'Richland County'
OR facility_sub_region_2 = 'Shelby County'
OR facility_sub_region_2 = 'Vermillion County');

UPDATE Vaccine_Facilities
SET Region = 'Region 7'
WHERE
facility_sub_region_1 = 'Illinois'
AND (facility_sub_region_2 = 'Will County'
OR facility_sub_region_2 = 'Kankakee County');

UPDATE Vaccine_Facilities
SET Region = 'Region 8'
WHERE
facility_sub_region_1 = 'Illinois'
AND (facility_sub_region_2 = 'DuPage County'
OR facility_sub_region_2 = 'Kane County');

UPDATE Vaccine_Facilities
SET Region = 'Region 9'
WHERE
facility_sub_region_1 = 'Illinois'
AND (facility_sub_region_2 = 'Lake County'
OR facility_sub_region_2 = 'McHenry County');

UPDATE Vaccine_Facilities
SET Region = 'Cook'
WHERE
facility_sub_region_1 = 'Illinois'
AND facility_sub_region_2 = 'Cook County';

/*Join Database Table with OHF Internal Table by IL COVID-19 Region*/
/*Count Number of Vaccine Facilities in each IL COVID-19 Region*/
SELECT Vaccine_Facilities.Region, COUNT(DISTINCT facility_place_id) AS NumFacilities, COVID_Access.Masks, COVID_Access.Tests
FROM Vaccine_Facilities
INNER JOIN
  COVID_Access ON
  Vaccine_Facilities.Region = COVID_Access.Region
GROUP BY Vaccine_Facilities.Region
ORDER BY Vaccine_Facilities.Region ASC

---
/* Vaccination Interest in IL During Peak of Surveying*/
SELECT *
FROM Vaccine_Interest
WHERE sub_region_1 = 'Illinois'
AND (DATE between '2021-03-01' and '2021-03-31')
AND sub_region_3_code IS NOT NULL
ORDER BY sub_region_3_code, DATE ASC;

/* Average Vaccination Interest in Main County in Each IL Region*/
SELECT AVG(sni_covid19_vaccination) AS Total_Average,

    (SELECT AVG(sni_covid19_vaccination)
    FROM Vaccine_Interest
    WHERE sub_region_1 = 'Illinois'
    AND sub_region_2 = 'Winnebago County'
    AND (DATE between '2021-03-01' and '2021-03-31')
    AND sub_region_3_code IS NOT NULL) AS Region1,

    (SELECT AVG(sni_covid19_vaccination)
    FROM Vaccine_Interest
    WHERE sub_region_1 = 'Illinois'
    AND sub_region_2 = 'Peoria County'
    AND (DATE between '2021-03-01' and '2021-03-31')
    AND sub_region_3_code IS NOT NULL) AS Region2,

    (SELECT AVG(sni_covid19_vaccination)
    FROM Vaccine_Interest
    WHERE sub_region_1 = 'Illinois'
    AND sub_region_2 = 'Sangamon County'
    AND (DATE between '2021-03-01' and '2021-03-31')
    AND sub_region_3_code IS NOT NULL) AS Region3,

    (SELECT AVG(sni_covid19_vaccination)
    FROM Vaccine_Interest
    WHERE sub_region_1 = 'Illinois'
    AND sub_region_2 = 'Madison County'
    AND (DATE between '2021-03-01' and '2021-03-31')
    AND sub_region_3_code IS NOT NULL) AS Region4,

    (SELECT AVG(sni_covid19_vaccination)
    FROM Vaccine_Interest
    WHERE sub_region_1 = 'Illinois'
    AND sub_region_2 = 'Marion County'
    AND (DATE between '2021-03-01' and '2021-03-31')
    AND sub_region_3_code IS NOT NULL) AS Region5,

    (SELECT AVG(sni_covid19_vaccination)
    FROM Vaccine_Interest
    WHERE sub_region_1 = 'Illinois'
    AND sub_region_2 = 'Champaign County'
    AND (DATE between '2021-03-01' and '2021-03-31')
    AND sub_region_3_code IS NOT NULL) AS Region6,

    (SELECT AVG(sni_covid19_vaccination)
    FROM Vaccine_Interest
    WHERE sub_region_1 = 'Illinois'
    AND sub_region_2 = 'Will County'
    AND (DATE between '2021-03-01' and '2021-03-31')
    AND sub_region_3_code IS NOT NULL) AS Region7,

    (SELECT AVG(sni_covid19_vaccination)
    FROM Vaccine_Interest
    WHERE sub_region_1 = 'Illinois'
    AND sub_region_2 = 'DuPage County'
    AND (DATE between '2021-03-01' and '2021-03-31')
    AND sub_region_3_code IS NOT NULL) AS Region8,

    (SELECT AVG(sni_covid19_vaccination)
    FROM Vaccine_Interest
    WHERE sub_region_1 = 'Illinois'
    AND sub_region_2 = 'Lake County'
    AND (DATE between '2021-03-01' and '2021-03-31')
    AND sub_region_3_code IS NOT NULL) AS Region9,

    (SELECT AVG(sni_covid19_vaccination)
    FROM Vaccine_Interest
    WHERE sub_region_1 = 'Illinois'
    AND sub_region_2 = 'Cook County'
    AND (DATE between '2021-03-01' and '2021-03-31')
    AND sub_region_3_code IS NOT NULL) AS Region10and11,
FROM
   Vaccine_Interest
WHERE DATE between '2021-03-01' and '2021-03-31'
AND sub_region_1 = 'Illinois';

/*Vaccination Interest in Main County in Each IL Region Throughout Surveying Period*/
SELECT *
FROM Vaccine_Interest
WHERE sub_region_1 = 'Illinois'
AND (DATE between '2020-11-01' and '2021-06-30'
      )
AND sub_region_2 = 'Winnebago County'
AND sub_region_3_code IS NOT NULL
ORDER BY sub_region_3_code, DATE ASC;

SELECT *
FROM Vaccine_Interest
WHERE sub_region_1 = 'Illinois'
AND (DATE between '2020-11-01' and '2021-06-30'
      )
AND sub_region_2 = 'Peoria County'
AND sub_region_3_code IS NOT NULL
ORDER BY sub_region_3_code, DATE ASC;

SELECT *
FROM Vaccine_Interest
WHERE sub_region_1 = 'Illinois'
AND (DATE between '2021-11-01' and '2021-06-30'
      )
AND sub_region_2 = 'Sangamon County'
AND sub_region_3_code IS NOT NULL
ORDER BY sub_region_3_code, DATE ASC;

SELECT *
FROM Vaccine_Interest
WHERE sub_region_1 = 'Illinois'
AND (DATE between '2020-11-01' and '2021-06-30'
      )
AND sub_region_2 = 'Madison County'
AND sub_region_3_code IS NOT NULL
ORDER BY sub_region_3_code, DATE ASC;

SELECT *
FROM Vaccine_Interest
WHERE sub_region_1 = 'Illinois'
AND (DATE between '2020-11-01' and '2021-06-30'
      )
AND sub_region_2 = 'Marion County'
AND sub_region_3_code IS NOT NULL
ORDER BY sub_region_3_code, DATE ASC;

SELECT *
FROM Vaccine_Interest
WHERE sub_region_1 = 'Illinois'
AND (DATE between '2020-11-01' and '2021-06-30'
      )
AND sub_region_2 = 'Champaign County'
AND sub_region_3_code IS NOT NULL
ORDER BY sub_region_3_code, DATE ASC;

SELECT *
FROM Vaccine_Interest
WHERE sub_region_1 = 'Illinois'
AND (DATE between '2020-11-01' and '2021-06-30'
      )
AND sub_region_2 = 'Will County'
AND sub_region_3_code IS NOT NULL
ORDER BY sub_region_3_code, DATE ASC;

SELECT *
FROM Vaccine_Interest
WHERE sub_region_1 = 'Illinois'
AND (DATE between '2020-11-01' and '2021-06-30'
      )
AND sub_region_2 = 'DuPage County'
AND sub_region_3_code IS NOT NULL
ORDER BY sub_region_3_code, DATE ASC;

SELECT *
FROM Vaccine_Interest
WHERE sub_region_1 = 'Illinois'
AND (DATE between '2020-11-01' and '2021-06-30'
      )
AND sub_region_2 = 'Lake County'
AND sub_region_3_code IS NOT NULL
ORDER BY sub_region_3_code, DATE ASC;

SELECT *
FROM Vaccine_Interest
WHERE sub_region_1 = 'Illinois'
AND sub_region_2 = 'Cook County'
AND (DATE between '2020-11-01' and '2021-06-30'
      )
AND sub_region_3_code IS NOT NULL
ORDER BY sub_region_3_code, DATE ASC;
